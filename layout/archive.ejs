<%
    var title = page.category || page.tag || 'Archives';
    postList = page.posts;
%>

<section class="archives">
    <% if(title) { %>
        <div class="archive-title"><%- title %></div>
    <% } %>
    <ul class="archive-list">
        <% 
        var dateShow, year, month;
        postList.each(function(item){ 
            item.year = date(item.date, 'YYYY');
            item.month = date(item.date, 'MM');
            dateShow = false;
            if(item.year !== year) {
                year = item.year;
                dateShow = true;
            }
            if(item.month !== month) {
                month = item.month;
                dateShow = true;
            }
            if(dateShow) {%>
                <div class="archive-date"><%= year + '-' + month %></div>
            <%}
            %>
            <%- partial('_partial/article-archive', {item: item}) %>
        <% }); 
        %>
    </ul>
</section><!-- end main -->
